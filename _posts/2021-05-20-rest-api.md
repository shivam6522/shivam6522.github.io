---
title: Django Rest API similar to Pastebin
date: 2021-05-20 11:20:20 +0530
# categories: [TOP_CATEGORIE, SUB_CATEGORIE]
categories: [ALL_PROJECTS]
tags: rest_api      # TAG names should always be lowercase
---


## Introduction

- Created a Model backed Browsable API which let userâ€™s share their code or any other text by creating snippets using the API. Additionally users have all the CRUD functionality with object level permission management and can change a few aesthetics.

## Features and Components

- MVT design pattern
    - In actual it resembles MVC the only diffrence is that Controller in MVC is equivalent to `views` in Django and views in MVC is equivalent to `templates` in Django.
    - In other words it's Acronym corresponding to **MVC** can be perceived as **MTV**.
- Serialization
    - first model instance is translated into python native data types like dict 
    - then the python data is formatted and rendered using JSON
    - finally rendered output is displayed using views.
- Deseralization
    - first we parse the user input string to python native data types
    - and then we convert them to fully populated object instance.
- CSRF(Cross-Site Request Forgery) token
    - A CSRF token is a unique, secret, unpredictable value that is generated by the server-side application and transmitted to the client in such a way that it is included in a subsequent HTTP request made by the client
    - used to check if the request is from a legitimate and authorised client.
- Request objects
    - similar to http request with some added functionlity.
    - request.POST - only works with POST method
    - request.data(in django) - works for POST, PUT and PATCH methods.
    - it can handle many formats of input data.
- Response objects
    - it's type of a template response.
    - renders correct content type as requested by the client for e.g(JSON type).
    - can reder response in many formats like html, JSON etc.
- Wrappers
    - decorators @api_view used with function based views.
    - class APIVIEW used with class based views.
    - these provide additional functions like handling parse error exception and adding context to response for content negotiaton
    - **content negotiation**
        - Content negotiation refers to mechanisms defined as a part of HTTP that make it possible to serve different versions of a document at the same URI.
        - Content Negotiation in REST APIs means resources can have multiple presentations, mostly because there may be multiple different clients expecting different representations.
- Adding fomat suffix to urls
    - urls can be used to retive data in different formats by providing different header content type in command line
    - http://127.0.0.1:8000/snippets.json  # JSON suffix
    - http://127.0.0.1:8000/snippets.api   # Browsable API suffix
- Function based views
    - we use functions to define views
- Class based views
    - it lets us reuse some common functionalities
    - one of the major benefit of this is we can use mixins and generic views etc.
    - **Mixins**
        - since all major CRUD  operations are same in all model backed APIs those are already implemented by rest framework's mixin classes
        - we use one generic class to provide core functionalities and use mixins each for create(), update(), retrive(), delete(), list() operations.
    - **Generic view**
        - rest framework provides some genric views with already mixed-in views like generics.ListCreateAPIView
        - it makes our code for views.py very little and clean
        - it's like God of all views
- find in detail about function and class based views [here](https://medium.com/@ksarthak4ever/django-class-based-views-vs-function-based-view-e74b47b2e41b)

- Authentication and permissions
    - Code snippets are always associated with a creator.
        - An owner field is created in model and auth.user is added (default auth model of django) as foreign key of this field and relate it with snippet
        - add snippet list and details views for users to get the associated snippets with their id.
    - Only authenticated users may create snippets.
        - A serializer class is created for user model with snippet model data as it's field because snippet is not related directly to user although reverse is true
    - Only the creator of a snippet may update or delete it.
        - associate snippets with user automatically by modyfying create() function of serializer and add owner username in snippet details
    - Unauthenticated requests should have full read-only access. 
        - using rest framework permissons module we can associate permissons to views like `IsAuthenticatedOrReadOnly` will permit read write to autheticated users and only read access to others.
    - object level permissions 
        - if the requested user is owner then we provide him edit access otherwise read-only access
        - for this we create a custom permission class and add it to our `SnippetDetail` view class's permissions property
    - login and logout views
        - add login url by including this in your urlpatterns - path('api-auth/', include('rest_framework.urls'))
    - authentcation
        - by default `SessionAuthentication` and `BasicAuthentication` is used when API is accessed through browser
        - if you access it through terminal or programmatically you need to provide authentication credentials on each request.
- snippet highlighting (highlight syntax)
    - A highlight field is created in model which also contains code snippet apart from raw code snippet field
    - use pygments library for this and style field of your model
- hyperlinks and pagination
    - Endpoint for root of our API is created which acts as an entry point to our API and contains the list of all the users and snippets.
    - Endpoint for highlighted snippet is created which is rendered using rest framework's pre-rendered html rather than using templates.
    -  Modify serializers to extend `HyperlinkedModelSerializer` instead of the existing `ModelSerializer`
    - The HyperlinkedModelSerializer has the following differences from ModelSerializer:
        - It does not include the id field by default.
        - It includes a url field, using HyperlinkedIdentityField.
        - Relationships use HyperlinkedRelatedField, instead of PrimaryKeyRelatedField.
    - In order to handle large number of user and snippet list pagination is added which restricts list size in a single page to 10 and adds page numbers.
- Browsable
    - API is fully browsable.
    - you can follow the links to find your way around in the API
- Used Viewsets and Routers
    - `Viewsets` allows the developer to concentrate on modeling the state and interactions of the API, and leave the URL construction to be handled automatically, based on common conventions.
    - `Routers` binds viewsets to url automatically all we need to do is to register appropriate viewsets with routers.
    - Registering the viewsets with the router is similar to providing a urlpattern. We include two arguments - the URL prefix for the views, and the viewset itself.
- used http response codes 
    - rest framework uses error codes with detail like  404_bad_request so that we don't use wrong code by mistake

    - 1xx - informational respons 
        - 100 - continue, everything is ok client should continue the request
    - 2xx - successful responses
        - 200 - ok request has succeeded
    - 3xx - redirect to different server
        - 300 - request has more than one possible response
        - 301 - requested resourse has moved permanently 
    - 4xx - client side error
        - 400 - bad request
        - 404 - requested resource not found
    - 5xx - server side error
        - 500 - internal server error
        - 503 - service unavailable


## Tools and Technologies Used
* Django
    * Development framework
* Django-rest-framework
    * The complete package to develop an API
* Python
    * programming language used to implement logic

## Links
* [github](https://github.com/shivam6522/Nodejs-authentication-system)
